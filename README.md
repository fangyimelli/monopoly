# 地產大亨 - 多人線上大富翁遊戲

一個完整的多人即時線上大富翁遊戲，使用 Node.js、Express、Socket.io 和現代化的前端技術開發。

## 🎮 遊戲特色

- **多人即時對戰**: 支援 2-8 位玩家同時遊戲
- **角色選擇系統**: 8個獨特角色可供選擇（帽子🎩、汽車🚗、狗🐕、貓🐱、船⛵、飛機✈️、靴子👢、頂針🔧）
- **完整遊戲規則**: 實現傳統大富翁的所有經典規則
- **現代化界面**: 響應式設計，支援桌面和移動設備
- **即時同步**: 使用 WebSocket 技術確保所有玩家狀態同步
- **房間系統**: 創建和加入遊戲房間
- **完整交易系統**: 地產買賣、房屋建造、租金收取
- **視覺化代表**: 每個玩家在遊戲板上都有獨特的角色圖標

## 🚀 快速開始

### 系統需求

- Node.js 14.0.0 或更高版本
- npm 或 yarn 包管理器
- 現代瀏覽器（Chrome、Firefox、Safari、Edge）

### 安裝步驟

1. **克隆專案**
   ```bash
   git clone <repository-url>
   cd monopoly
   ```

2. **安裝依賴**
   ```bash
   npm install
   ```

3. **啟動服務器**
   ```bash
   npm start
   ```

4. **開始遊戲**
   打開瀏覽器訪問 `http://localhost:3000`

### 開發模式

如果您想要進行開發，可以使用開發模式（需要安裝 nodemon）：

```bash
npm install -g nodemon
npm run dev
```

## 🎯 遊戲規則

### 基本玩法

1. **遊戲開始**: 每位玩家從起點 GO 開始，擁有 $1,500 起始資金
2. **回合制**: 玩家輪流擲骰子，根據點數移動棋子
3. **地產購買**: 停留在無主地產時可以購買
4. **租金收取**: 其他玩家停留在您的地產上需要支付租金
5. **建設房屋**: 擁有同色地產組可以建造房屋和旅館
6. **勝利條件**: 其他玩家破產後，剩下的最富有玩家獲勝

### 特殊格子

- **GO**: 經過或停留時領取 $200
- **監獄**: 特定情況下會被送入監獄
- **機會/公益福利**: 抽取卡牌執行指令
- **稅收**: 支付指定金額
- **免費停車**: 無事發生

### 建築規則

- 必須擁有同色地產組才能建造房屋
- 房屋必須平均建造在同色地產上
- 建造 4 棟房屋後可以升級為旅館
- 出售時必須按照建造的相反順序

## 🛠️ 技術架構

### 後端技術

- **Node.js**: JavaScript 運行環境
- **Express**: Web 應用框架
- **Socket.io**: 即時雙向通訊
- **UUID**: 唯一識別碼生成

### 前端技術

- **HTML5**: 結構標記
- **CSS3**: 樣式和動畫
- **JavaScript ES6+**: 前端邏輯
- **Socket.io Client**: 客戶端即時通訊
- **Font Awesome**: 圖標庫
- **Google Fonts**: 字體

### 項目結構

```
monopoly/
├── public/                 # 前端資源
│   ├── css/
│   │   └── styles.css     # 主要樣式文件
│   ├── js/
│   │   ├── main.js        # 主程式入口
│   │   ├── game.js        # 遊戲邏輯
│   │   ├── ui.js          # UI 管理
│   │   └── board.js       # 棋盤管理
│   └── index.html         # 主頁面
├── server/                 # 後端邏輯
│   └── GameManager.js     # 遊戲狀態管理
├── server.js              # 服務器入口
├── package.json           # 項目配置
└── README.md             # 項目說明
```

## 🎮 遊戲操作

### 創建房間

1. 點擊「創建房間」
2. 輸入您的遊戲名稱
3. 選擇您喜歡的角色（帽子、汽車、狗、貓、船、飛機、靴子、頂針）
4. 分享房間代碼給其他玩家

### 加入房間

1. 點擊「加入房間」
2. 輸入您的遊戲名稱和房間代碼
3. 選擇可用的角色（已被選擇的角色會顯示為不可用）
4. 等待房主開始遊戲

### 遊戲中操作

- **擲骰子**: 點擊「擲骰子」按鈕
- **購買地產**: 停留在可購買地產時點擊「購買地產」
- **建造房屋**: 點擊「建造房屋」選擇要建造的地產
- **結束回合**: 完成行動後點擊「結束回合」

### 鍵盤快捷鍵

- **空格鍵**: 擲骰子（輪到您時）
- **ESC**: 關閉彈出視窗
- **Tab**: 在元素間導航

## 🔧 配置選項

### 服務器配置

可以通過環境變量配置服務器：

```bash
PORT=3000 npm start
```

### 遊戲配置

遊戲的基本設置可以在 `server/GameManager.js` 中修改：

- 起始資金
- 房屋和旅館數量
- 地產價格和租金
- 卡牌內容

## 🌟 功能亮點

### 即時多人遊戲

- 使用 WebSocket 技術實現即時同步
- 支援斷線重連
- 房間管理系統

### 響應式設計

- 支援桌面、平板和手機
- 現代化的用戶界面
- 流暢的動畫效果

### 無障礙設計

- 鍵盤導航支援
- 螢幕閱讀器友好
- 高對比度選項

### 遊戲完整性

- 完整的大富翁規則實現
- 防作弊機制
- 遊戲狀態驗證

## 🚀 部署

### 本地部署

項目已經可以在本地運行，只需要安裝依賴並啟動即可。

### 生產環境部署

1. **安裝依賴**
   ```bash
   npm install --production
   ```

2. **設置環境變量**
   ```bash
   export NODE_ENV=production
   export PORT=80
   ```

3. **啟動服務**
   ```bash
   npm start
   ```

### Docker 部署

```dockerfile
FROM node:16-alpine
WORKDIR /app
COPY package*.json ./
RUN npm install --production
COPY . .
EXPOSE 3000
CMD ["npm", "start"]
```

## 🤝 貢獻

歡迎提交 Issue 和 Pull Request！

### 開發流程

1. Fork 本專案
2. 創建功能分支 (`git checkout -b feature/AmazingFeature`)
3. 提交更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 開啟 Pull Request

### 代碼規範

- 使用 ES6+ 語法
- 遵循現有的代碼風格
- 添加適當的註釋
- 確保代碼可讀性

## 📝 更新日誌

### v1.1.5 (2025-07-16)

- 🏠 修復多房間互相影響的嚴重問題
- 🔧 改善玩家離開時的房間狀態管理
- 🎯 修復當前玩家索引在玩家離開時的錯誤處理
- 📡 確保房間事件正確廣播，避免跨房間干擾
- 🛡️ 強化房間隔離機制，確保每個房間獨立運行
- 📊 添加詳細的調試日誌幫助問題診斷

### v1.1.4 (2025-07-16)

- 🗺️ 修復地圖位置名稱與玩家位置顯示不匹配的問題
- 🇹🇼 統一使用台灣主題地名（台北101、日月潭、故宮博物院等）
- 🎨 更新棋盤顯示和服務器端數據保持一致
- 📍 確保所有位置名稱在遊戲中正確對應
- 🔧 改善遊戲體驗和視覺一致性

### v1.1.3 (2025-07-16)

- 🐛 修復玩家可以連續擲骰子的重大遊戲平衡問題
- 🎲 添加回合狀態管理，確保每回合只能擲一次骰子（除非是雙重骰子）
- 🔒 強化服務器端驗證，防止重複擲骰子的作弊行為
- 🎮 改善雙重骰子的處理邏輯和額外回合管理
- 📊 增強按鈕狀態管理和用戶反饋
- 🛡️ 提升遊戲公平性和規則一致性

### v1.1.2 (2025-07-16)

- 🐛 修復玩家無法擲骰子的問題
- 🎮 修復遊戲狀態中 currentPlayerIndex 缺失問題
- 🏁 改進回合管理和按鈕狀態更新
- 🗺️ 修復棋盤玩家位置顯示問題
- 📊 添加詳細的調試日誌和錯誤追蹤

### v1.1.1 (2025-07-16)

- 🐛 修復 Socket.io 連接問題
- 🔧 添加缺失的遊戲方法 (getCurrentPlayerData, getPositionName)
- 📊 改進錯誤處理和調試功能
- 🎯 修復遊戲狀態更新問題
- ⚡ 提升連接穩定性和用戶體驗

### v1.1.0 (2025-07-16)

- ✨ 新增角色選擇系統
- 🎭 8個獨特角色可供選擇
- 🎨 增強的用戶界面和視覺效果
- 🎮 遊戲板上顯示角色圖標
- 💫 角色選擇動畫和互動效果
- 🔒 角色唯一性確保（每個房間中角色不重複）

### v1.0.0 (2025-07-16)

- ✨ 初始版本發布
- 🎮 完整的多人大富翁遊戲
- 🌐 即時網路對戰
- 📱 響應式設計
- ♿ 無障礙功能

## 📄 授權

本專案使用 MIT 授權 - 詳見 [LICENSE](LICENSE) 文件

## 🆘 問題解決

### 常見問題

**Q: 遊戲無法連接到服務器**
A: 請確認服務器已經啟動並且防火牆允許對應端口

**Q: 在移動設備上顯示不正常**
A: 確保使用現代瀏覽器，建議使用 Chrome 或 Safari

**Q: 遊戲中途斷線了怎麼辦**
A: 重新整理頁面，遊戲會自動處理斷線玩家

### 技術支援

如果遇到技術問題，請：

1. 檢查瀏覽器控制台的錯誤訊息
2. 確認 Node.js 版本是否符合要求
3. 查看服務器日誌輸出
4. 提交詳細的 Issue 報告

## 🎯 未來計劃

- [ ] 添加遊戲歷史記錄
- [ ] 實現觀戰模式
- [ ] 添加更多遊戲主題
- [ ] 支援自定義遊戲規則
- [ ] 添加聊天功能
- [ ] 實現成就系統
- [ ] 支援離線AI對戰

---

**享受您的地產大亨之旅！** 🏠💰🎲
